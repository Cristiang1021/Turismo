{% extends "base.html" %}

{% block title %}Recomendaciones{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="highlight-banner position-relative mb-4 rounded-lg overflow-hidden">
    <div class="highlight-banner-image" style="background-image: url('{{ url_for('static', filename='recomendaciones.png') }}');"></div>
    <div class="highlight-text position-absolute w-100 h-100 d-flex flex-column justify-content-center align-items-center text-white">
        <h1 class="display-4">Encuentra las mejores recomendaciones para ti!</h1>
        <p class="lead">Basadas en tus preferencias</p>
    </div>
    </div>

    {% if not respuestas %}

    <div class="container mt-5">
    <div class="text-center mb-4">
        <h2>Encuentra Tu Actividad Ideal</h2>
        <p>Selecciona tus preferencias</p>
    </div>
    <form method="POST" action="{{ url_for('main.recomendaciones') }}">
        {{ form.hidden_tag() }}
        {% if form.errors %}
            <div class="alert alert-danger">
                <ul>
                {% for field, errors in form.errors.items() %}
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
                </ul>
            </div>
        {% endif %}
        <div class="row">
            <!-- Pregunta 1 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-icons mr-2"></i>
                        {{ form.pregunta1.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta1 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-icons mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
             <!-- Pregunta 6 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        {{ form.pregunta6.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta6 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-calendar-alt mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Pregunta 4 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-clock mr-2"></i>
                        {{ form.pregunta4.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta4 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-clock mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Pregunta 7 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-dollar-sign mr-2"></i>
                        {{ form.pregunta7.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta7 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-dollar-sign mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Pregunta 3 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-heartbeat mr-2"></i>
                        {{ form.pregunta3.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta3 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-heartbeat mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Pregunta 2 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-tachometer-alt mr-2"></i>
                        {{ form.pregunta2.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta2 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-tachometer-alt mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- Pregunta 5 -->
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-user-tie mr-2"></i>
                        {{ form.pregunta5.label(class="form-label font-weight-bold mb-0") }}
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        {% for choice in form.pregunta5 %}
                            <div class="custom-control custom-radio custom-control-inline">
                                {{ choice(class="custom-control-input") }}
                                <label class="custom-control-label btn btn-outline-primary m-2 d-flex align-items-center" for="{{ choice.id }}">
                                    <i class="fas fa-user-tie mr-2"></i> {{ choice.label.text }}
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

        </div>
        <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary btn-lg">Enviar</button>
        </div>
    </form>
</div>


    {% else %}
    {% if recomendaciones %}
    <div class="row" id="actividades-container">
        {% for actividad in recomendaciones[:3] %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <img src="{{ url_for('main.get_actividad_image', id=actividad.imagenes[0].id) }}" class="card-img-top" alt="{{ actividad.nombre }}" style="height: 200px; object-fit: cover;">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">{{ actividad.nombre }}</h5>
                    <p class="card-text">{{ actividad.descripcion[:100] }}...</p>
                    <div class="mt-auto">
                        <a href="{{ url_for('main.ver_actividad', id=actividad.id) }}" class="btn btn-warning btn-sm">Ver más</a>
                    </div>
                </div>
                <div class="card-footer">
                    <span class="badge {% if actividad.nivel_dificultad == 'Fácil' %}badge-success{% elif actividad.nivel_dificultad == 'Medio' %}badge-warning{% else %}badge-danger{% endif %}">
                        {{ actividad.nivel_dificultad }}
                    </span>
                    <span class="float-right">${{ actividad.precio_referencial }}</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>No hay actividades recomendadas en este momento.</p>
    {% endif %}
    {% endif %}
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
    const radioButtons = document.querySelectorAll('.custom-control-input');

    radioButtons.forEach(button => {
        button.addEventListener('change', function () {
            const label = this.nextElementSibling;
            const allLabels = this.closest('.d-flex').querySelectorAll('.custom-control-label');

            // Desactivar todos los labels de la misma pregunta
            allLabels.forEach(lbl => lbl.classList.remove('active'));

            // Activar el label seleccionado
            if (this.checked) {
                label.classList.add('active');
            }
        });
    });
});

</script>
<style>
    .custom-control-label {
    padding: 10px 20px;
    border-radius: 20px;
    transition: background-color 0.3s, color 0.3s;
}

.custom-control-label.active {
    background-color: #007bff;
    color: #fff;
}

</style>

{% endblock %}
